{% set months = { 1: 'Jan', 2: 'Fev', 3: 'Mar', 4: 'Abr', 5: 'Mai', 6: 'Jun', 7: 'Jul', 8: 'Ago', 9: 'Set', 10: 'Ago', 11: 'Nov', 12: 'Dez' } %}

{% extends 'layout/layout.html.twig' %}

{% block page_title %} <i class="fa-solid fa-house"></i> Home{% endblock %}

{% block content %}
    <div id='home-charts' class="cntainer-fluid shadow bg-full-white rounded-3">
        <div class="row justify-content-center">
            <div class="col-5" id='chart_div0'></div>
            <div class="col-5" id='chart_div1'></div>
        </div>
        <div class="row justify-content-center">
            <div class="container-fluid" id='chart_div2'></div>
        </div>
    </div>
{% endblock content %}
{% block custom_js %}
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
	setTimeout(
		() => {
			google.charts.load('current', {'packages':['corechart']});
			google.charts.setOnLoadCallback(drawChart);
		}
		, 1000);

      function drawChart() {

        var opened = new google.visualization.arrayToDataTable([
			['Dia', 'Quantidade'],
			{% for item in openedData %}
				['{{ item.Dia }}', {{ item.Quantidade }}],
			{% endfor %}
		]);

		var closed = new google.visualization.arrayToDataTable([
			['Dia', 'Quantidade'],
			{% for item in closedData %}
				['{{ item.Dia }}', {{ item.Quantidade }}],
			{% endfor %}
		]);

		var monthly = new google.visualization.arrayToDataTable([
			['Mês', 'Abertos', 'Fechados'],
			 {% for item in monthlyData %}
				['{{ months[item.month] }}', {{ item.opened }}, {{ item.finished }}],
			{% endfor %}
		]);

        var options0 = {
			title:'Chamados abertos por Dia',
			legend: { position: 'top' },
			width: 400,
			height:300,
			minValue: 0,
			hAxis: {
				title: 'Dia',
			},
			vAxis:{
				title: 'Quantidade'
			},
			colors: ['#41ADDB'],
			animation:{
				duration: 1000,
				easing: 'out',
				startup: true
			},
		};

		var options1 = {
			title:'Chamados fechados por Dia',
			legend: { position: 'top' },
			width:400,
			height:300,
			minValue: 0,
			hAxis: {
				title: 'Dia',
			},
			vAxis:{
				title: 'Quantidade'
			},
			colors: ['#53B953'],
			animation:{
				duration: 1000,
				easing: 'out',
				startup: true
			},
		};

		var options2 = {
			title:'Análise Mensal',
			legend: { position: 'top' },
			width: 'auto',
			height:300,
			minValue: 0,
			hAxis: {
				title: 'Mês',
			},
			vAxis:{
				'title': 'Quantidade'
			},
			colors: ['#41ADDB', '#53B953'],
			animation:{
				duration: 1000,
				easing: 'out',
				startup: true
			},
		};

        var chart0 = new google.visualization.ColumnChart(document.getElementById('chart_div0'));
        var chart1 = new google.visualization.ColumnChart(document.getElementById('chart_div1'));
        var chart2 = new google.visualization.ColumnChart(document.getElementById('chart_div2'));

        chart0.draw(opened, options0);
        chart1.draw(closed, options1);
        chart2.draw(monthly, options2);
      }

    </script>
{% endblock %}